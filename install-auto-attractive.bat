@echo off
chcp 65001 >nul 2>&1
setlocal EnableDelayedExpansion
:: 笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ
:: 至 Claude-AppsScript-Pro 鬲疲ｳ輔・蜈ｨ閾ｪ蜍輔う繝ｳ繧ｹ繝医・繝ｩ繝ｼ v3.1 至
:: 決 譛鬮倥↓繝ｯ繧ｯ繝ｯ繧ｯ繝ｻ繝峨く繝峨く縺ｮ髢狗匱菴馴ｨ薙ｒ縺雁ｱ翫￠・・決
:: 氏 菴懈・譌･: 2025.08.19 - 縺ゅ↑縺溘・螟｢繧貞掌縺医ｋ鬲疲ｳ輔・繝・・繝ｫ! 氏
:: 笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ検笨ｨ
:: 識 PowerShell螳溯｡梧､懷・・・せ繝槭・繝郁・蜍募喧讖溯・
set "POWERSHELL_MODE=false"
echo %CMDCMDLINE% | find /i "powershell" >nul && set "POWERSHELL_MODE=true"
:: 噫 螳悟・閾ｪ蜍輔Δ繝ｼ繝会ｼ育腸蠅・､画焚蛻ｶ蠕｡・・if "%AUTO_INSTALL_MODE%"=="true" set "POWERSHELL_MODE=true"
title 検 Claude-AppsScript-Pro 鬲疲ｳ輔・繧､繝ｳ繧ｹ繝医・繝ｩ繝ｼ v3.1 - 縺ゅ↑縺溘・髢狗匱莠ｺ逕溘′螟峨ｏ繧翫∪縺呻ｼ・検
echo.
echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
echo 笊・                                                                             笊・echo 笊・ 至脂至 Claude-AppsScript-Pro 鬲疲ｳ輔・蜈ｨ閾ｪ蜍輔う繝ｳ繧ｹ繝医・繝ｩ繝ｼ v3.1 至脂至       笊・echo 笊・                                                                             笊・echo 笊・              笨ｨ決 譛鬮倥↓繝ｯ繧ｯ繝ｯ繧ｯ縺吶ｋ髢狗匱菴馴ｨ薙ｒ縺雁ｱ翫￠・・決笨ｨ               笊・echo 笊・                                                                             笊・echo 笊・        噫櫨 Google Apps Script髢狗匱繧帝擠蜻ｽ逧・↓蜉ｹ邇・喧縺励∪縺呻ｼ・櫨噫         笊・echo 笊・                                                                             笊・echo 笊・                   氏 縺ゅ↑縺溘・螟｢繧貞掌縺医ｋ鬲疲ｳ輔・繝・・繝ｫ 氏                    笊・echo 笊・                                                                             笊・echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
echo.
echo 武笨ｨ 鬲疲ｳ輔・髢句ｧ区凾蛻ｻ: %TIME%
echo 刀牒 鬲疲ｳ輔・菴懈･ｭ繝・ぅ繝ｬ繧ｯ繝医Μ: %CD%
if "%POWERSHELL_MODE%"=="true" (
    echo ､問圍 螳溯｡後Δ繝ｼ繝・ PowerShell螳悟・閾ｪ蜍輔Δ繝ｼ繝会ｼ郁ｶ・ｫ倬溘そ繝・ヨ繧｢繝・・・Å泅・・) else (
    echo 側検 螳溯｡後Δ繝ｼ繝・ 蟇ｾ隧ｱ蝙九う繝ｳ繧ｹ繝医・繝ｫ繝｢繝ｼ繝会ｼ亥ｮ牙ｿ・ぎ繧､繝我ｻ倥″猪・・)
echo.
echo 識決 莉頑律縺ｮ鬲疲ｳ輔・蟾･遞九・繝ｬ繝薙Η繝ｼ:
echo   1・鞘Ε笨ｨ 蝓ｺ譛ｬ繧ｷ繧ｹ繝・Β繧ｻ繝・ヨ繧｢繝・・・亥悄蜿ｰ縺ｮ鬲疲ｳ呆沛ｰ・・echo   2・鞘Ε柏 OAuth隱崎ｨｼ險ｭ螳夲ｼ磯ｭ疲ｳ慕噪Web繧､繝ｳ繧ｿ繝ｼ繝輔ぉ繝ｼ繧ｹ倹・・echo   3・鞘Ε迫 Claude Desktop邨ｱ蜷郁ｨｭ螳夲ｼ亥ｿ・ｒ縺､縺ｪ縺宣ｭ疲ｳ呆汳晢ｼ・echo   4・鞘Ε至 蜍穂ｽ懃｢ｺ隱搾ｼ・ｮ檎挑螳御ｺ・ｼ育･晉ｦ上・鬲疲ｳ呆沁会ｼ・echo.
echo 蒔鹿 貅門ｙ螳御ｺ・ｼÅ沁ｭ蒔 譛鬮倥・繧ｻ繝・ヨ繧｢繝・・菴馴ｨ薙ｒ髢句ｧ九＠縺ｾ縺・..
echo.
echo 牒笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏≫煤笏Å汳ｫ
echo.
:: 繧､繝ｳ繧ｹ繝医・繝ｫ繝ｭ繧ｰ菴懈・
set "LOG_FILE=install-auto.log"
echo [%DATE% %TIME%] 脂 鬲疲ｳ輔・蜈ｨ閾ｪ蜍輔う繝ｳ繧ｹ繝医・繝ｫ髢句ｧ具ｼ・> %LOG_FILE%
:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・:: 検 Step 1: 蝓ｺ譛ｬ繧､繝ｳ繧ｹ繝医・繝ｫ螳溯｡鯉ｼ医Ρ繧ｯ繝ｯ繧ｯ縺ｮ隨ｬ荳豁ｩ噫・・:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
echo 笊・                                                                               笊・echo 笊・ 検笨ｨ Step 1/4: 蝓ｺ譛ｬ繧ｷ繧ｹ繝・Β繧ｻ繝・ヨ繧｢繝・・荳ｭ... 笨ｨ検                            笊・echo 笊・ 逃氏 蠢・ｦ√↑繧ｳ繝ｳ繝昴・繝阪Φ繝医ｒ諢帶ュ霎ｼ繧√※貅門ｙ縺励※縺・∪縺呻ｼ・氏逃                   笊・echo 笊・                                                                               笊・echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
echo.
echo 売牒 繝励Ο繧ｰ繝ｬ繧ｹ: [笆遺毎笆遺毎笆遺毎笆遺毎笆鯛桝] 10%% - 蝓ｺ譛ｬ繧､繝ｳ繧ｹ繝医・繝ｫ髢句ｧ・. 牒売
echo.
call install-windows.bat >> %LOG_FILE% 2>&1
if %ERRORLEVEL% NEQ 0 (
    echo.
    echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
    echo 笊・                                                                         笊・    echo 笊・ ・懲 縺ゅｉ繧峨∝渕譛ｬ繧､繝ｳ繧ｹ繝医・繝ｫ縺ｧ縺｡繧・▲縺ｨ縺励◆鬲疲ｳ輔・繝溘せ縺瑚ｵｷ縺阪∪縺励◆       笊・    echo 笊・ 庁検 縺ｧ繧ょ､ｧ荳亥､ｫ・・ｭ疲ｳ輔・隗｣豎ｺ譁ｹ豕輔ｒ縺疲｡亥・縺・◆縺励∪縺・検庁                 笊・    echo 笊・                                                                         笊・    echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
    echo.
    echo 剥醗 蝠城｡後・隧ｳ邏ｰ: 
    echo    塘搭 繝ｭ繧ｰ繝輔ぃ繧､繝ｫ: %LOG_FILE% 繧偵＃遒ｺ隱阪￥縺縺輔＞
    echo.
    echo 庁決 鬲疲ｳ輔・隗｣豎ｺ繝偵Φ繝・
    echo    肌笞｡ Node.js縺後う繝ｳ繧ｹ繝医・繝ｫ縺輔ｌ縺ｦ縺・ｋ縺狗｢ｺ隱・    echo    童倹 繧､繝ｳ繧ｿ繝ｼ繝阪ャ繝域磁邯壹ｒ遒ｺ隱・    echo    売竢ｰ 縺励・繧峨￥蠕・▲縺ｦ縺九ｉ蜀榊ｮ溯｡後ｒ縺願ｩｦ縺励￥縺縺輔＞
    echo.
    echo [%DATE% %TIME%] 笶悟渕譛ｬ繧､繝ｳ繧ｹ繝医・繝ｫ縺ｧ繧ｨ繝ｩ繝ｼ縺檎匱逕・>> %LOG_FILE%
    if "%POWERSHELL_MODE%"=="false" (
        echo 識猪 Enter繧ｭ繝ｼ繧呈款縺励※邨ゆｺ・＠縺ｾ縺・.
        pause >nul
    )
    exit /b 1
)
echo 笨・沁・繝励Ο繧ｰ繝ｬ繧ｹ: [笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎] 25%% - 蝓ｺ譛ｬ繧､繝ｳ繧ｹ繝医・繝ｫ螳御ｺ・ｼ・脂笨・echo.
echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
echo 笊・                                                                               笊・echo 笊・ 至笨ｨ Step 1 螳御ｺ・ｼ∝渕譛ｬ繧ｷ繧ｹ繝・Β縺ｮ貅門ｙ縺後〒縺阪∪縺励◆・・笨ｨ至                      笊・echo 笊・ 噫検 谺｡縺ｯ讌ｽ縺励＞OAuth險ｭ螳壹↓騾ｲ縺ｿ縺ｾ縺呻ｼ・検噫                                    笊・echo 笊・                                                                               笊・echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
echo.
echo [%DATE% %TIME%] 笨・渕譛ｬ繧､繝ｳ繧ｹ繝医・繝ｫ螳御ｺ・>> %LOG_FILE%
:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・:: 柏 Step 2: OAuth險ｭ螳夂｢ｺ隱搾ｼ・ｮ溯｡鯉ｼ磯ｭ疲ｳ慕噪Web繧ｨ繧ｯ繧ｹ繝壹Μ繧ｨ繝ｳ繧ｹ倹・・:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
echo 笊・                                                                               笊・echo 笊・ 柏検 Step 2/4: OAuth隱崎ｨｼ險ｭ螳・                                                 笊・echo 笊・ 倹牒 鬲疲ｳ輔・蜈ｨ閾ｪ蜍標eb繧､繝ｳ繧ｿ繝ｼ繝輔ぉ繝ｼ繧ｹ縺ｧ邁｡蜊倩ｨｭ螳夲ｼ・牒倹                        笊・echo 笊・                                                                               笊・echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
echo.
echo 売決 繝励Ο繧ｰ繝ｬ繧ｹ: [笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎] 25%% - OAuth險ｭ螳夂憾豕√ｒ遒ｺ隱堺ｸｭ... 決売
:: OAuth迥ｶ豕√ｒ遒ｺ隱・call :CheckOAuthStatus
if "%OAUTH_STATUS%"=="COMPLETE" (
    echo 笨・沁・繝励Ο繧ｰ繝ｬ繧ｹ: [笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎] 50%% - OAuth險ｭ螳夂匱隕具ｼ・至笨・    echo.
    echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
    echo 笊・                                                                         笊・    echo 笊・ 脂猪 邏譎ｴ繧峨＠縺・ｼ＾Auth險ｭ螳壹′譌｢縺ｫ螳御ｺ・＠縺ｦ縺・∪縺呻ｼ・猪脂                   笊・    echo 笊・ 泊笨ｨ CLIENT_ID + REFRESH_TOKEN 縺梧ｭ｣蟶ｸ縺ｫ險ｭ螳壽ｸ医∩縺ｧ縺呻ｼ・笨ｨ泊              笊・    echo 笊・                                                                         笊・    echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
    echo.
    echo [%DATE% %TIME%] 笨・Auth險ｭ螳夂｢ｺ隱肴ｸ医∩ >> %LOG_FILE%
    goto :OAuthComplete
)
echo 売牒 繝励Ο繧ｰ繝ｬ繧ｹ: [笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆鯛桝笆鯛桝] 35%% - OAuth險ｭ螳壹′蠢・ｦ√〒縺・. 牒売
echo.
echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
echo 笊・                                                                         笊・echo 笊・ 牒耳 OAuth險ｭ螳壹〒鬲疲ｳ輔・蜈ｨ閾ｪ蜍標eb繧ｨ繧ｯ繧ｹ繝壹Μ繧ｨ繝ｳ繧ｹ繧剃ｽ馴ｨ薙＠縺ｾ縺励ｇ縺・ｼ・      笊・echo 笊・ 検至 邁｡蜊倥・讌ｽ縺励＞繝ｻ鄒弱＠縺・う繝ｳ繧ｿ繝ｼ繝輔ぉ繝ｼ繧ｹ繧偵＃逕ｨ諢上＠縺ｾ縺励◆・・至検       笊・echo 笊・                                                                         笊・echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
:: PowerShell繝｢繝ｼ繝画凾縺ｯ閾ｪ蜍募ｮ溯｡・if "%POWERSHELL_MODE%"=="true" (
    echo.
    echo ､問圍 PowerShell閾ｪ蜍輔Δ繝ｼ繝会ｼ・ｭ疲ｳ慕噪OAuth險ｭ螳壹ｒ閾ｪ蜍暮幕蟋具ｼ・笞｡､・    call :AutoOAuth
    goto :OAuthVerificationStep
)
:: 蟇ｾ隧ｱ蝙九Δ繝ｼ繝峨〒縺ｮOAuth險ｭ螳・echo.
echo 搭検 Google Cloud Console 縺ｧ縺ｮ貅門ｙ縺ｫ縺､縺・※:
echo.
echo    迫倹 繧｢繧ｯ繧ｻ繧ｹ: https://console.cloud.google.com/apis/credentials
echo    筐｡・鞘惠 縲瑚ｪ崎ｨｼ諠・ｱ繧剃ｽ懈・縲坂・縲薫Auth 2.0 繧ｯ繝ｩ繧､繧｢繝ｳ繝・D縲阪ｒ驕ｸ謚・echo    倹識 繧｢繝励Μ繧ｱ繝ｼ繧ｷ繝ｧ繝ｳ縺ｮ遞ｮ鬘・ 縲後え繧ｧ繝悶い繝励Μ繧ｱ繝ｼ繧ｷ繝ｧ繝ｳ縲・echo    売迫 謇ｿ隱肴ｸ医∩繝ｪ繝繧､繝ｬ繧ｯ繝・RI: http://localhost:3001/oauth/callback
echo.
echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
echo 笊・                                                                         笊・echo 笊・ 識決 鬲疲ｳ慕噪OAuth險ｭ螳壹ｒ髢句ｧ九＠縺ｾ縺吶°・・                                   笊・echo 笊・ 笨ｨ至 鄒弱＠縺Цeb繧､繝ｳ繧ｿ繝ｼ繝輔ぉ繝ｼ繧ｹ縺碁幕縺阪∪縺呻ｼ・至笨ｨ                        笊・echo 笊・                                                                         笊・echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
echo.
set /p OAUTH_CHOICE="櫨猪 莉翫☆縺宣ｭ疲ｳ慕噪OAuth險ｭ螳壹ｒ髢句ｧ九☆繧具ｼ・(Y/N): "
if /i "!OAUTH_CHOICE!"=="Y" (
    echo.
    echo 噫検 鬲疲ｳ慕噪OAuth險ｭ螳壹ｒ髢句ｧ九＠縺ｾ縺呻ｼ・検噫
    call :AutoOAuth
) else (
    echo.
    echo ・牒 莠・ｧ｣縺励∪縺励◆・∝ｾ後〒險ｭ螳壹＆繧後ｋ蝣ｴ蜷医・莉･荳九・繧ｳ繝槭Φ繝峨ｒ螳溯｡後＠縺ｦ縺上□縺輔＞:
    echo    統庁 npm run oauth-setup
    echo.
    echo [%DATE% %TIME%] 統OAuth險ｭ螳壹ｒ繧ｹ繧ｭ繝・・ >> %LOG_FILE%
)
:OAuthVerificationStep
echo.
echo 売笨ｨ OAuth險ｭ螳壹・邨先棡繧堤｢ｺ隱堺ｸｭ... 笨ｨ売
call :CheckOAuthStatus
if "%OAUTH_STATUS%"=="COMPLETE" (
    echo 笨・沁・OAuth險ｭ螳壼ｮ御ｺ・ｼ・至笨・) else (
    echo 笞・条汳｡ OAuth險ｭ螳壹′荳榊ｮ悟・縺ｧ縺吶よ焔蜍戊ｨｭ螳壹′蠢・ｦ√°繧ゅ＠繧後∪縺帙ｓ縲・)
:OAuthComplete
echo 笨・沍・繝励Ο繧ｰ繝ｬ繧ｹ: [笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎] 50%% - OAuth險ｭ螳壹せ繝・ャ繝怜ｮ御ｺ・ｼ・検笨・echo.
echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
echo 笊・                                                                               笊・echo 笊・ 至柏 Step 2 螳御ｺ・ｼ＾Auth隱崎ｨｼ險ｭ螳壹′謨ｴ縺・∪縺励◆・・柏至                          笊・echo 笊・ 噫笨ｨ 谺｡縺ｯClaude Desktop縺ｨ縺ｮ鬲疲ｳ輔・邨ｱ蜷医〒縺呻ｼ・笨ｨ噫                            笊・echo 笊・                                                                               笊・echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
echo.
echo [%DATE% %TIME%] 笨・Auth險ｭ螳壹せ繝・ャ繝怜ｮ御ｺ・>> %LOG_FILE%
:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・:: 迫 Step 3: Claude Desktop邨ｱ蜷郁ｨｭ螳夲ｼ亥ｿ・ｒ縺､縺ｪ縺宣ｭ疲ｳ呆汳晢ｼ・:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
echo 笊・                                                                               笊・echo 笊・ 迫喋 Step 3/4: Claude Desktop邨ｱ蜷郁ｨｭ螳・                                       笊・echo 笊・ 牒､・Claude縺ｨAppsScript繧帝ｭ疲ｳ輔〒縺､縺ｪ縺偵∪縺呻ｼ・､晰汳ｫ                            笊・echo 笊・                                                                               笊・echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
echo.
echo 売決 繝励Ο繧ｰ繝ｬ繧ｹ: [笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎] 50%% - Claude Desktop險ｭ螳壻ｸｭ... 決売
echo.
echo 識庁 Claude Desktop險ｭ螳壹ｒ閾ｪ蜍墓峩譁ｰ縺励∪縺・..
node scripts\update-claude-config.cjs >> %LOG_FILE% 2>&1
if %ERRORLEVEL% EQU 0 (
    echo 笨・沁・Claude Desktop險ｭ螳壹ｒ閾ｪ蜍墓峩譁ｰ螳御ｺ・ｼ・至笨・    echo [%DATE% %TIME%] 笨・laude Desktop險ｭ螳夊・蜍墓峩譁ｰ螳御ｺ・>> %LOG_FILE%
) else (
    echo 笞・条汳｡ 閾ｪ蜍墓峩譁ｰ縺ｫ螟ｱ謨励＠縺ｾ縺励◆縲よ焔蜍戊ｨｭ螳壹・譯亥・繧偵＠縺ｾ縺・..
    echo [%DATE% %TIME%] 笞・修laude Desktop險ｭ螳夊・蜍墓峩譁ｰ螟ｱ謨・>> %LOG_FILE%
    echo.
    echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
    echo 笊・                                                                         笊・    echo 笊・ 統牒 謇句虚險ｭ螳壹・譁ｹ豕輔ｒ縺疲｡亥・縺励∪縺呻ｼ・                                    笊・    echo 笊・                                                                         笊・    echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
    echo.
    echo 刀肌 險ｭ螳壹ヵ繧｡繧､繝ｫ蝣ｴ謇: %APPDATA%\Claude\claude_desktop_config.json
    echo.
    echo 統笨ｨ 霑ｽ蜉縺吶ｋ險ｭ螳壼・螳ｹ:
    echo.
    echo {
    echo   "mcpServers": {
    echo     "claude-appsscript-pro": {
    echo       "command": "node",
    echo       "args": ["%CD%\server.js"],
    echo       "cwd": "%CD%"
    echo     }
    echo   }
    echo }
    echo.
)
echo 笨・沍・繝励Ο繧ｰ繝ｬ繧ｹ: [笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎] 75%% - Claude Desktop邨ｱ蜷亥ｮ御ｺ・ｼ・検笨・echo.
echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
echo 笊・                                                                               笊・echo 笊・ 至迫 Step 3 螳御ｺ・ｼ，laude Desktop縺ｨ縺ｮ邨ｱ蜷医′謨ｴ縺・∪縺励◆・・迫至                 笊・echo 笊・ 噫識 譛蠕後・蜍穂ｽ懃｢ｺ隱阪〒螳檎挑縺ｫ莉穂ｸ翫￡縺ｾ縺呻ｼ・識噫                                笊・echo 笊・                                                                               笊・echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
echo.
echo [%DATE% %TIME%] 笨・laude Desktop邨ｱ蜷亥ｮ御ｺ・>> %LOG_FILE%
:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・:: 至 Step 4: 蜍穂ｽ懃｢ｺ隱搾ｼ・ｮ檎挑螳御ｺ・ｼ育･晉ｦ上・鬲疲ｳ呆沁会ｼ・:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
echo 笊・                                                                               笊・echo 笊・ 至脂 Step 4/4: 蜍穂ｽ懃｢ｺ隱搾ｼ・ｮ檎挑螳御ｺ・                                           笊・echo 笊・ 笨ｨ醗 鬲疲ｳ輔・譛邨ゅメ繧ｧ繝・け縺ｧ螳檎挑縺ｫ莉穂ｸ翫￡縺ｾ縺呻ｼ・醗笨ｨ                             笊・echo 笊・                                                                               笊・echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
echo.
echo 売決 繝励Ο繧ｰ繝ｬ繧ｹ: [笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎] 75%% - 譛邨ょ虚菴懃｢ｺ隱堺ｸｭ... 決売
echo.
echo 剥笨ｨ server.js 讒区枚繝√ぉ繝・け螳溯｡御ｸｭ...
node --check server.js >> %LOG_FILE% 2>&1
if %ERRORLEVEL% EQU 0 (
    echo 笨・沁・讒区枚繝√ぉ繝・け螳御ｺ・ｼ√☆縺ｹ縺ｦ豁｣蟶ｸ縺ｧ縺呻ｼ・至笨・    echo [%DATE% %TIME%] 笨・ｧ区枚繝√ぉ繝・け謌仙粥 >> %LOG_FILE%
) else (
    echo 笶交沽・讒区枚繧ｨ繝ｩ繝ｼ縺檎匱隕九＆繧後∪縺励◆...
    echo [%DATE% %TIME%] 笶梧ｧ区枚繝√ぉ繝・け螟ｱ謨・>> %LOG_FILE%
    echo 塘庁 隧ｳ邏ｰ: %LOG_FILE% 繧偵＃遒ｺ隱阪￥縺縺輔＞
)
echo.
echo 識投 繧ｷ繧ｹ繝・Β諠・ｱ遒ｺ隱・..
echo 桃検 Node.js 繝舌・繧ｸ繝ｧ繝ｳ: 
node --version 2>>%LOG_FILE%
echo 桃牒 npm 繝舌・繧ｸ繝ｧ繝ｳ: 
npm --version 2>>%LOG_FILE%
echo.
echo 笨・沁・繝励Ο繧ｰ繝ｬ繧ｹ: [笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎笆遺毎] 100%% - 螳悟・螳御ｺ・ｼ・至笨・echo.
:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・:: 脂 螳御ｺ・Γ繝・そ繝ｼ繧ｸ・・ｬ｡縺ｮ繧ｹ繝・ャ繝玲｡亥・
:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・echo.
echo 笊披武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶風
echo 笊・                                                                                 笊・echo 笊・                    至脂至 螳檎挑螳御ｺ・♀繧√〒縺ｨ縺・＃縺悶＞縺ｾ縺呻ｼ・至脂至                 笊・echo 笊・                                                                                 笊・echo 笊・    笨ｨ検 Claude-AppsScript-Pro v3.1 縺ｮ繧ｻ繝・ヨ繧｢繝・・縺悟ｮ御ｺ・＠縺ｾ縺励◆・・検笨ｨ        笊・echo 笊・                                                                                 笊・echo 笊・                  噫牒 邏譎ｴ繧峨＠縺・幕逋ｺ縺ｮ譌・′蟋九∪繧翫∪縺呻ｼ・牒噫                   笊・echo 笊・                                                                                 笊・echo 笊壺武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶幅
echo.
echo 識決 谺｡縺ｮ繧ｹ繝・ャ繝・
echo.
echo   1・鞘Ε売 Claude Desktop 繧貞・襍ｷ蜍輔＠縺ｦ縺上□縺輔＞
echo      庁笨ｨ 險ｭ螳壹ｒ蜿肴丐縺輔○繧九◆繧√↓蠢・ｦ√〒縺・echo.
echo   2・鞘Εｧｪ Claude 縺ｧ謗･邯壹ユ繧ｹ繝医ｒ螳溯｡・
echo      統牒 claude-appsscript-pro:test_connection
echo.
echo   3・鞘Ε噫 讌ｽ縺励＞髢狗匱繧帝幕蟋・
echo      町至 縲後ち繧ｹ繧ｯ邂｡逅・す繧ｹ繝・Β繧剃ｽ懊▲縺ｦWeb縺ｧ菴ｿ縺医ｋ繧医≧縺ｫ縺励※縲・echo      検笨ｨ 縺ｪ縺ｩ縺ｨ隧ｱ縺励°縺代※縺ｿ縺ｦ縺上□縺輔＞・・echo.
echo 投庁 繧､繝ｳ繧ｹ繝医・繝ｫ隧ｳ邏ｰ:
echo   肌笞｡ 繝・・繝ｫ謨ｰ: 61蛟九・蠑ｷ蜉帙↑繝・・繝ｫ
echo   倹識 讖溯・: AI閾ｪ蠕矩幕逋ｺ繝ｻ繝ｪ繧｢繝ｫ繧ｿ繧､繝繝・ヰ繝・げ繝ｻ螳悟・閾ｪ蜍募喧
echo   刀猪 繝ｭ繧ｰ繝輔ぃ繧､繝ｫ: %LOG_FILE%
echo.
echo.
echo 庁検 驥崎ｦ・ Claude Desktop 縺ｮ蜀崎ｵｷ蜍輔・謇句虚縺ｧ陦後▲縺ｦ縺上□縺輔＞
echo    - 閾ｪ蜍戊ｵｷ蜍輔・陦後＞縺ｾ縺帙ｓ
echo    - 繝ｦ繝ｼ繧ｶ繝ｼ縺ｮ繧ｿ繧､繝溘Φ繧ｰ縺ｧ螳牙・縺ｫ蜀崎ｵｷ蜍輔〒縺阪∪縺・
echo [%DATE% %TIME%] 至繧､繝ｳ繧ｹ繝医・繝ｫ螳御ｺ・>> %LOG_FILE%
echo.
echo 至脂 繧ｻ繝・ヨ繧｢繝・・縺悟ｮ御ｺ・＠縺ｾ縺励◆・・脂至
echo.
echo 牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒
echo.
echo 庁笨ｨ 縺翫▽縺九ｌ縺輔∪縺ｧ縺励◆・・笨ｨ庁
echo    氏猪 Claude-AppsScript-Pro v3.1 縺ｮ繧ｻ繝・ヨ繧｢繝・・縺悟ｮ御ｺ・＠縺ｾ縺励◆・・猪氏
echo    噫検 邏譎ｴ繧峨＠縺・幕逋ｺ縺ｮ蜀帝匱繧偵♀讌ｽ縺励∩縺上□縺輔＞・・検噫
echo.
echo 牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒決牒
echo.
pause
goto :eof
:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・:: 剥 繧ｵ繝悶Ν繝ｼ繝√Φ: OAuth迥ｶ豕∫｢ｺ隱・:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・:CheckOAuthStatus
set "OAUTH_STATUS=INCOMPLETE"
:: .env 繝輔ぃ繧､繝ｫ縺ｮ蟄伜惠遒ｺ隱・if not exist ".env" (
    set "OAUTH_STATUS=INCOMPLETE"
    goto :eof
)
:: CLIENT_ID 縺ｨ REFRESH_TOKEN 縺ｮ遒ｺ隱・findstr /C:"GOOGLE_APP_SCRIPT_API_CLIENT_ID" .env >nul 2>&1
if %ERRORLEVEL% NEQ 0 (
    set "OAUTH_STATUS=INCOMPLETE"
    goto :eof
)
findstr /C:"GOOGLE_APP_SCRIPT_API_REFRESH_TOKEN" .env >nul 2>&1
if %ERRORLEVEL% NEQ 0 (
    set "OAUTH_STATUS=INCOMPLETE"
    goto :eof
)
:: CLIENT_ID 縺ｨ REFRESH_TOKEN 縺檎ｩｺ縺ｧ縺ｪ縺・％縺ｨ繧堤｢ｺ隱・for /f "tokens=2 delims==" %%i in ('findstr /C:"GOOGLE_APP_SCRIPT_API_CLIENT_ID" .env') do (
    if "%%i"=="" (
        set "OAUTH_STATUS=INCOMPLETE"
        goto :eof
    )
)
for /f "tokens=2 delims==" %%i in ('findstr /C:"GOOGLE_APP_SCRIPT_API_REFRESH_TOKEN" .env') do (
    if "%%i"=="" (
        set "OAUTH_STATUS=INCOMPLETE"
        goto :eof
    )
)
set "OAUTH_STATUS=COMPLETE"
goto :eof
:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・:: 噫 繧ｵ繝悶Ν繝ｼ繝√Φ: 閾ｪ蜍桧Auth險ｭ螳・:: 笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊・:AutoOAuth
echo 売検 OAuth險ｭ螳壹せ繧ｯ繝ｪ繝励ヨ繧貞ｮ溯｡御ｸｭ... 検売
node scripts\oauth-setup.cjs >> %LOG_FILE% 2>&1
if %ERRORLEVEL% EQU 0 (
    echo 笨・沁・OAuth險ｭ螳壹′豁｣蟶ｸ縺ｫ螳御ｺ・＠縺ｾ縺励◆・・至笨・    echo [%DATE% %TIME%] 笨・Auth險ｭ螳壼ｮ御ｺ・>> %LOG_FILE%
) else (
    echo 笶交沽・OAuth險ｭ螳壹〒繧ｨ繝ｩ繝ｼ縺檎匱逕溘＠縺ｾ縺励◆...
    echo [%DATE% %TIME%] 笶薫Auth險ｭ螳壹お繝ｩ繝ｼ >> %LOG_FILE%
    echo 塘庁 隧ｳ邏ｰ: %LOG_FILE% 繧偵＃遒ｺ隱阪￥縺縺輔＞
    echo.
    echo 庁肌 謇句虚險ｭ螳壽婿豕・
    echo    統笨ｨ npm run oauth-setup 繧貞ｮ溯｡後＠縺ｦ縺上□縺輔＞
)
goto :eof
